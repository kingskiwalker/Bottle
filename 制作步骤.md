[TOC]
### 开始
网上看到一个大神写了个水瓶的shader感觉十分酷炫
于是我也学着他的方法来学习一下
### 拆解步骤

#### 水位模拟
一开始先实现一下比较简单的步骤，让水瓶无论处于哪个角度都呈现水面是水平的。\
高度在什么情况下可以保持不变呢？\
设想一下 如果当前的高度是根据世界坐标的高度进行clicp的话 是不是就能保持在一个平面呢\
那是不是就是将当前顶点的高度与它在世界坐标的高度进行对比 然后进行判断是渲染还是舍弃就行了。\
但是这样得出来的效果会导致物体的水平面是根据世界坐标的高度进行决定的。\
我们的想要的效果应该是根据输入的值离物体的中心点的距离来觉得水面高度。\
相当于将物体的世界坐标再减去自身原点的世界坐标。\
又或者在通过矩阵转换时不对w轴进行转换。



```
float4 RotateAroundYInDegrees (float4 vertex, float degrees)
    {
        float alpha = degrees * UNITY_PI / 180;
        float sina, cosa;
        sincos(alpha, sina, cosa);
        // float2x2 m = float2x2(cosa, sina, -sina, cosa); //旋转矩阵 绕原点进行旋转
        // return float4(vertex.yz , mul(m, vertex.xz)).xzyw ; // 由于这里是将物体进行横置 实际上并不需要浪费性能进行旋转计算只需要调换xzy轴位置就好
        return float4(vertex.yzxz).xzyw;
    }
```


好懒 不想写了。。。 后面慢慢补上分析 脚本有注释了
![image](https://raw.githubusercontent.com/kingskiwalker/Bottle/master/Image/1589771103(1).png)

### 大神原地址
> 参考 :  https://www.patreon.com/posts/quick-game-art-18245226
